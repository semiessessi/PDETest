#include "Test_SunPosition.h"

#include "Test_Position.h"

#include "Ephemerides/Sun/SunVSOP87Model.h"

bool Test_SunPosition::Run()
{
    // SE: test the Schlyter model a bit, make sure it is correct against
    // a whole bunch of test values...

    // source of test data is JPL HORIZONS
    static const struct TestValue
    {
        double mdEclipticX;
        double mdEclipticY;
        double mdEclipticZ;
        double mdJDT;

    } kaxTestValues[] =
    {
        { -3.426253484986353E-03, -1.913211932780508E-03, 9.908228498653654E-05, 2438761.5 },
        { -1.102822213964956E-03, -3.290678804191800E-03, 6.267822654807907E-05, 2439126.5 },
        { 1.395235191733597E-03, -3.290751541901910E-03, 1.503788640086791E-05, 2439491.5 },
        { 3.385964367726666E-03, -2.116836118669339E-03, -2.842289976681989E-05, 2439856.5 },
        { 4.414692573842029E-03, -2.160441206483855E-04, -5.563244199656648E-05, 2440222.5 },
        { 4.306786483674715E-03, 1.837535134108785E-03, -6.089583868599628E-05, 2440587.5 },
        { 3.153700744647706E-03, 3.474911982763331E-03, -4.403173203741657E-05, 2440952.5 },
        { 1.277658352112627E-03, 4.231295177668362E-03, -1.001772784407615E-05, 2441317.5 },
        { -7.742330274255701E-04, 3.812040136451463E-03, 2.987781961593268E-05, 2441683.5 },
        { -2.333942699367791E-03, 2.224269350933158E-03, 6.131292627438122E-05, 2442048.5 },
        { -2.778468005151758E-03, -1.194711401857811E-04, 6.921984498624721E-05, 2442413.5 },
        { -1.789810629751267E-03, -2.496008257600606E-03, 4.372602209210982E-05, 2442778.5 },
        { 4.503521180205563E-04, -4.081196528569996E-03, -1.330365562213211E-05, 2443144.5 },
        { 3.319108347999031E-03, -4.308090089886810E-03, -8.986709141485449E-05, 2443509.5 },
        { 6.031055927699592E-03, -3.079956556520105E-03, -1.680738914425163E-04, 2443874.5 },
        { 7.910520820292664E-03, -6.831840725656365E-04, -2.308214955131640E-04, 2444239.5 },
        { 8.549040815298250E-03, 2.353462904056597E-03, -2.667069279622298E-04, 2444605.5 },
        { 7.807233478796654E-03, 5.378171550149091E-03, -2.693265471473500E-04, 2444970.5 },
        { 5.835670348697199E-03, 7.803816747876102E-03, -2.393595507252648E-04, 2445335.5 },
        { 3.035848499008042E-03, 9.120864945420921E-03, -1.839682855207993E-04, 2445700.5 },
        { -1.075435991689678E-05, 9.043991966341210E-03, -1.145206371589091E-04, 2446066.5 },
        { -2.551167393376622E-03, 7.612928394122425E-03, -4.845932126030406E-05, 2446431.5 },
        { -3.955192045719071E-03, 5.254887544859802E-03, -1.891271181902826E-06, 2446796.5 },
        { -3.912938435382593E-03, 2.745931281303493E-03, 1.513517216835787E-05, 2447161.5 },
        { -2.608347676036406E-03, 8.897694639029425E-04, 2.639240890389810E-06, 2447527.5 },
        { -6.722335008625326E-04, 2.222456726499567E-04, -2.754081857941140E-05, 2447892.5 },
        { 1.152001389890090E-03, 8.222854435832109E-04, -5.950322124851102E-05, 2448257.5 },
        { 2.255351852935850E-03, 2.380671762116081E-03, -7.902191925608652E-05, 2448622.5 },
        { 2.270754109048786E-03, 4.384466469848849E-03, -7.585419593335718E-05, 2448988.5 },
        { 1.134808424740476E-03, 6.240648439904473E-03, -4.687832582327273E-05, 2449353.5 },
        { -9.653544194210434E-04, 7.386260143307775E-03, 5.445038398012428E-06, 2449718.5 },
        { -3.610893331341392E-03, 7.403761576782245E-03, 7.341322958937348E-05, 2450083.5 },
        { -6.177391463806346E-03, 6.071895708549887E-03, 1.430065151879864E-04, 2450449.5 },
        { -7.953678194435935E-03, 3.524790291419123E-03, 1.976803362359616E-04, 2450814.5 },
        { -8.346487384157292E-03, 2.976055790235678E-04, 2.216446366471382E-04, 2451179.5 },
        { -7.139143380212696E-03, -2.792019770161695E-03, 2.061838852554663E-04, 2451544.5 },
        { -4.634180819074568E-03, -4.923203933588234E-03, 1.550390383462735E-04, 2451910.5 },
        { -1.538489447269972E-03, -5.590889481213931E-03, 8.182604338480137E-05, 2452275.5 },
        { 1.361794291898999E-03, -4.785206071398129E-03, 4.361669479785488E-06, 2452640.5 },
        { 3.424681292414833E-03, -2.840633018167155E-03, -6.081463399164020E-05, 2453005.5 },
        { 4.297898854887472E-03, -2.991454355910753E-04, -1.033979704742540E-04, 2453371.5 },
        { 3.878814520379925E-03, 2.203669870358841E-03, -1.175158330309611E-04, 2453736.5 },
        { 2.356739356681156E-03, 4.110114090232909E-03, -1.042932038753558E-04, 2454101.5 },
        { 1.561402529627539E-04, 4.953005432015677E-03, -7.105631884623408E-05, 2454466.5 },
        { -2.120161820177565E-03, 4.514909613327879E-03, -2.928753239672593E-05, 2454832.5 },
        { -3.747147775505799E-03, 2.926587035303590E-03, 4.446807296978075E-06, 2455197.5 },
        { -4.173780866999707E-03, 7.099588260976209E-04, 1.604543950090037E-05, 2455562.5 },
        { -3.241860503087535E-03, -1.331451169463513E-03, -8.437146026922850E-07, 2455927.5 },
        { -1.284282111761733E-03, -2.455154076901959E-03, -4.207238483437137E-05, 2456293.5 },
        { 9.868769745243237E-04, -2.277782350730992E-03, -9.307326473444218E-05, 2456658.5 },
        { 2.841029214124732E-03, -8.551488389783957E-04, -1.372196345812671E-04, 2457023.5 },
        { 3.737881713150281E-03, 1.402397586692506E-03, -1.612700291840256E-04, 2457388.5 },
        { 3.385544381243392E-03, 3.936621791448463E-03, -1.561189977455406E-04, 2457754.5 },
        { 1.802714649171610E-03, 6.130427000981004E-03, -1.202133131815178E-04, 2458119.5 },
        { -7.558735329017875E-04, 7.428856011015974E-03, -5.737173235978416E-05, 2458484.5 },
        { -3.798619468647882E-03, 7.439926519813711E-03, 2.303011840607446E-05, 2458849.5 },
        { -6.651221878460021E-03, 6.003891578947420E-03, 1.056805875144459E-04, 2459215.5 },
        { -8.580124876710206E-03, 3.347345552066668E-03, 1.730043677509378E-04, 2459580.5 },
        { -9.054435383841772E-03, 9.526131059291741E-05, 2.100766294494946E-04, 2459945.5 },
        { -7.967246493036666E-03, -2.905922391263947E-03, 2.102259000549587E-04, 2460310.5 },
        { -5.729897860905880E-03, -4.910250492680156E-03, 1.794331652946295E-04, 2460676.5 },
        { -3.066608675494800E-03, -5.533021089203827E-03, 1.316110726337760E-04, 2461041.5 },
        { -7.054302473454828E-04, -4.872320872542287E-03, 8.288170817836051E-05, 2461406.5 },
        { 8.120380740241887E-04, -3.306377630680974E-03, 4.703938489712948E-05, 2461771.5 },
        { 1.233914588304981E-03, -1.381317117320865E-03, 3.123171989505673E-05, 2462137.5 },
        { 5.495776062535038E-04, 3.134055770695670E-04, 3.834286444433259E-05, 2462502.5 },
        { -9.787570917423915E-04, 1.279257397932493E-03, 6.468501505864004E-05, 2462867.5 },
        { -2.873582453644109E-03, 1.147258219149997E-03, 1.009976029867639E-04, 2463232.5 },
        { -4.505748115943298E-03, -1.834414406802811E-04, 1.344000963457217E-04, 2463598.5 },
        { -5.198382198373560E-03, -2.429874044684905E-03, 1.489092745616245E-04, 2463963.5 },
        { -4.515968293282126E-03, -4.957751115063111E-03, 1.326877946037735E-04, 2464328.5 },
    };

    POSITION_TEST( SunVSOP87EOrbitalEphemeris, "Sun Position", 0.0035 );
    return true;
}
