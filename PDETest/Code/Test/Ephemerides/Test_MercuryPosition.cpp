#include "Test_MercuryPosition.h"

#include "Test_Position.h"

#include "Ephemerides/Mercury/MercurySchlyterModel.h"

bool Test_MercuryPosition::Run()
{
	// SE: test the Schlyter model a bit, make sure it is correct against
	// a whole bunch of test values...

	// source of test data is JPL HORIZONS
	static const struct TestValue
	{
		double mdEclipticX;
		double mdEclipticY;
		double mdEclipticZ;
		double mdJDT;

	} kaxTestValues[] =
    {
        { -3.431459960619446E-01, 1.162764313226954E-01, 4.096101200842196E-02, 2438761.5 },
        { -3.716421387238631E-01, -2.238550760423625E-01, 1.609762822499751E-02, 2439126.5 },
        { -1.647938559412043E-01, -4.376046434998661E-01, -2.017686869549711E-02, 2439491.5 },
        { 1.256861769022909E-01, -4.352212911530366E-01, -4.662539264899484E-02, 2439856.5 },
        { 3.507474581014240E-01, -1.745804268138610E-01, -4.610828804459262E-02, 2440222.5 },
        { 2.608031036290285E-01, 1.941548012009124E-01, -7.920680050178134E-03, 2440587.5 },
        { -1.443210687332045E-01, 2.856554595432172E-01, 3.654365317459229E-02, 2440952.5 },
        { -3.871824140638050E-01, -6.976474840549512E-03, 3.475806441785902E-02, 2441317.5 },
        { -2.993182497789883E-01, -3.359587026688860E-01, -2.904160755663987E-04, 2441683.5 },
        { -4.068372970685560E-02, -4.604333383607574E-01, -3.419420220281419E-02, 2442048.5 },
        { 2.363743820779658E-01, -3.559236900366469E-01, -5.095049721406765E-02, 2442413.5 },
        { 3.568194720462057E-01, -3.942791177536246E-02, -3.590965577883312E-02, 2442778.5 },
        { 9.117861014914563E-02, 2.894764167878661E-01, 1.562549332765741E-02, 2443144.5 },
        { -2.953170252572122E-01, 1.708130275333641E-01, 4.163780838321446E-02, 2443509.5 },
        { -3.807216421373468E-01, -1.679024931916690E-01, 2.189127299953857E-02, 2443874.5 },
        { -2.050154081871173E-01, -4.113075196647146E-01, -1.420923874698871E-02, 2444239.5 },
        { 1.018581244819565E-01, -4.416799467590539E-01, -4.509777460255471E-02, 2444605.5 },
        { 3.329679291987481E-01, -2.282332552813086E-01, -4.920774841156944E-02, 2444970.5 },
        { 3.082950942478943E-01, 1.404067901728454E-01, -1.718478299137871E-02, 2445335.5 },
        { -6.968062346928137E-02, 3.119475048481767E-01, 3.122453823871309E-02, 2445700.5 },
        { -3.799302242936318E-01, 3.388373883849093E-02, 3.679986299421061E-02, 2446066.5 },
        { -3.343779871458120E-01, -2.888979055414519E-01, 6.204286157029886E-03, 2446431.5 },
        { -9.420179489173969E-02, -4.516638819127885E-01, -2.903333582489145E-02, 2446796.5 },
        { 1.915510919828083E-01, -3.893928198284868E-01, -4.995954997155766E-02, 2447161.5 },
        { 3.574911415911232E-01, -7.501195570899889E-02, -3.925880724124890E-02, 2447527.5 },
        { 1.630412119247936E-01, 2.639078798268759E-01, 6.478303986397422E-03, 2447892.5 },
        { -2.450521888618888E-01, 2.261450780830471E-01, 4.094759926761246E-02, 2448257.5 },
        { -3.923257573031171E-01, -1.031476187702213E-01, 2.752623438891327E-02, 2448622.5 },
        { -2.358752965794925E-01, -3.896493326214679E-01, -1.039830035287296E-02, 2448988.5 },
        { 4.263018500809571E-02, -4.509261224602735E-01, -4.119837391583737E-02, 2449353.5 },
        { 2.949829051687550E-01, -2.797499934647651E-01, -5.061651308300830E-02, 2449718.5 },
        { 3.313168327097145E-01, 7.433900063851727E-02, -2.520420759090468E-02, 2450083.5 },
        { -3.412385812326731E-02, 3.136363809489982E-01, 2.783139031057486E-02, 2450449.5 },
        { -3.642818650779075E-01, 9.050397556243288E-02, 4.001019714999839E-02, 2450814.5 },
        { -3.673824435986708E-01, -2.474931524358341E-01, 1.293502857852647E-02, 2451179.5 },
        { -1.478672233442572E-01, -4.466929775364947E-01, -2.313937582786786E-02, 2451544.5 },
        { 1.640923115386238E-01, -4.145627187126673E-01, -4.879478030704296E-02, 2451910.5 },
        { 3.522327133105219E-01, -1.473953706201906E-01, -4.397153160482055E-02, 2452275.5 },
        { 2.292076215857592E-01, 2.148606958884807E-01, -2.963295903192799E-03, 2452640.5 },
        { -1.799631036997922E-01, 2.630692892214171E-01, 3.849281061395635E-02, 2453005.5 },
        { -3.906250066475542E-01, -7.069882531207292E-02, 3.038855289554223E-02, 2453371.5 },
        { -2.751770581921562E-01, -3.577376056128284E-01, -3.914686981664395E-03, 2453736.5 },
        { -8.660204120045025E-03, -4.586358808827442E-01, -3.689868239741537E-02, 2454101.5 },
        { 2.602148208137757E-01, -3.292244628782728E-01, -5.123727708368511E-02, 2454466.5 },
        { 3.453129204577082E-01, 3.243193034587757E-02, -2.962973187535249E-02, 2454832.5 },
        { 4.715831111175716E-02, 3.056015767171350E-01, 2.006272440161815E-02, 2455197.5 },
        { -3.254274782745596E-01, 1.470377217581768E-01, 4.144866270460365E-02, 2455562.5 },
        { -3.824910136306806E-01, -1.955726970983496E-01, 1.892636729513723E-02, 2455927.5 },
        { -1.699403659176373E-01, -4.357045540916858E-01, -1.996647695389002E-02, 2456293.5 },
        { 1.207138059004780E-01, -4.365387430471273E-01, -4.656000296377556E-02, 2456658.5 },
        { 3.401540875319301E-01, -2.044550792740463E-01, -4.772012105321857E-02, 2457023.5 },
        { 2.841555165313506E-01, 1.658248924367604E-01, -1.245296011883873E-02, 2457388.5 },
        { -1.399864014117794E-01, 2.876459933199791E-01, 3.617958712269478E-02, 2457754.5 },
        { -3.859054833019958E-01, -1.654307689835697E-03, 3.481192038201179E-02, 2458119.5 },
        { -3.159243724530365E-01, -3.122664112956987E-01, 2.732130737118981E-03, 2458484.5 },
        { -6.713349519259719E-02, -4.534054004610565E-01, -3.182458153238026E-02, 2458849.5 },
        { 2.303619059089229E-01, -3.519817385484654E-01, -5.088893247126657E-02, 2459215.5 },
        { 3.504480247964183E-01, -3.740706917164405E-02, -3.609001393165544E-02, 2459580.5 },
        { 1.179185748906315E-01, 2.811263946394577E-01, 1.152932225110091E-02, 2459945.5 },
        { -2.825976187000438E-01, 1.974562840420854E-01, 4.177425502635603E-02, 2460310.5 },
        { -3.930329062905830E-01, -1.666344458882603E-01, 2.248715698971456E-02, 2460676.5 },
        { -2.182679121578918E-01, -4.147406371423878E-01, -1.357165947309572E-02, 2461041.5 },
        { 6.793626867789840E-02, -4.561896960169756E-01, -4.309623818807915E-02, 2461406.5 },
        { 3.129110527096434E-01, -2.634903635118322E-01, -4.984032912857222E-02, 2461771.5 },
        { 3.059517834527960E-01, 1.276555108471073E-01, -1.736868360893661E-02, 2462137.5 },
        { -6.773944505250193E-02, 3.038168048208428E-01, 3.110593043198717E-02, 2462502.5 },
        { -3.708477669187226E-01, 5.627834561853907E-02, 3.847940574730642E-02, 2462867.5 },
        { -3.485156269131940E-01, -2.725861224999921E-01, 9.425454379825626E-03, 2463232.5 },
        { -9.736441455127078E-02, -4.566182780165982E-01, -2.865563907041180E-02, 2463598.5 },
        { 1.879163160839976E-01, -3.963458417812378E-01, -4.975508381040225E-02, 2463963.5 },
        { 3.539713270358037E-01, -1.130666621784169E-01, -4.157509185308090E-02, 2464328.5 },
	};

    POSITION_TEST( MercurySchlyterOrbitalEphemeris, "Mercury Position", 1.0 );
	return true;
}
