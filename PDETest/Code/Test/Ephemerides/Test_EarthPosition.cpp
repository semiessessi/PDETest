#include "Test_EarthPosition.h"

#include "Test_Position.h"

#include "Ephemerides/Earth/EarthSchlyterModel.h"

bool Test_EarthPosition::Run()
{
	// SE: test the Schlyter model a bit, make sure it is correct against
	// a whole bunch of test values...

	// source of test data is JPL HORIZONS
	static const struct TestValue
	{
		double mdEclipticX;
		double mdEclipticY;
		double mdEclipticZ;
		double mdJDT;

	} kaxTestValues[] =
    {
        { -1.888094885260383E-01, 9.637491293908086E-01, 1.738447510064971E-04, 2438761.500000000 },
        { -1.820439064745353E-01, 9.632197765247581E-01, 1.367727834338978E-04, 2439126.500000000 },
        { -1.751035713445483E-01, 9.640490307418657E-01, 8.725893307622267E-05, 2439491.500000000 },
        { -1.687515899559958E-01, 9.659927849640122E-01, 4.084108105877073E-05, 2439856.500000000 },
        { -1.805154193204395E-01, 9.655279035389419E-01, 1.198220884276024E-05, 2440222.500000000 },
        { -1.762579423144942E-01, 9.684273952999964E-01, 2.589337636733001E-06, 2440587.500000000 },
        { -1.729947557991504E-01, 9.708491829304599E-01, 1.644366914640904E-05, 2440952.500000000 },
        { -1.703971981711416E-01, 9.723897061359656E-01, 4.942112058474973E-05, 2441317.500000000 },
        { -1.852661118841166E-01, 9.696043775303367E-01, 8.844463716938863E-05, 2441683.500000000 },
        { -1.823523716046855E-01, 9.688947987957099E-01, 1.192703261407845E-04, 2442048.500000000 },
        { -1.783516992448723E-01, 9.673980085815772E-01, 1.241881651774220E-04, 2442413.500000000 },
        { -1.730175552049791E-01, 9.657934833008218E-01, 9.454238265815480E-05, 2442778.500000000 },
        { -1.835639060729833E-01, 9.618486345397214E-01, 3.594552274604083E-05, 2443144.500000000 },
        { -1.763122130885172E-01, 9.624686814568727E-01, -4.359338425565243E-05, 2443509.500000000 },
        { -1.691710457702367E-01, 9.644952211375750E-01, -1.237852368978695E-04, 2443874.500000000 },
        { -1.628593449564959E-01, 9.676816260926608E-01, -1.873977920639504E-04, 2444239.500000000 },
        { -1.750910742844070E-01, 9.683588670302860E-01, -2.253319009866845E-04, 2444605.500000000 },
        { -1.714060002383068E-01, 9.722205984945138E-01, -2.297310722777516E-04, 2444970.500000000 },
        { -1.689404060052604E-01, 9.754452100871457E-01, -2.026204104524719E-04, 2445335.500000000 },
        { -1.673473944314496E-01, 9.775125729058071E-01, -1.500826200842390E-04, 2445700.500000000 },
        { -1.831264666559671E-01, 9.750981561050437E-01, -8.114112771379486E-05, 2446066.500000000 },
        { -1.812522535511495E-01, 9.745392570990494E-01, -1.841509502622161E-05, 2446431.500000000 },
        { -1.782158092014930E-01, 9.729957421124505E-01, 2.452756876676981E-05, 2446796.500000000 },
        { -1.737613684547332E-01, 9.712725574101347E-01, 3.942420001781728E-05, 2447161.500000000 },
        { -1.853174957378932E-01, 9.670712452171049E-01, 2.502267298091001E-05, 2447527.500000000 },
        { -1.789343182688165E-01, 9.672436577960097E-01, -5.552925048137363E-06, 2447892.500000000 },
        { -1.726736163855648E-01, 9.686612120326057E-01, -3.901455742840328E-05, 2448257.500000000 },
        { -1.672140807360602E-01, 9.709813539085251E-01, -6.130533656154651E-05, 2448622.500000000 },
        { -1.800010554568281E-01, 9.706523395950296E-01, -5.958421925740338E-05, 2448988.500000000 },
        { -1.767678763215678E-01, 9.733438174383501E-01, -3.490724448995016E-05, 2449353.500000000 },
        { -1.744439751150922E-01, 9.752581751742897E-01, 1.424476684616274E-05, 2449718.500000000 },
        { -1.726216331167400E-01, 9.760458511958334E-01, 8.144448019543412E-05, 2450083.500000000 },
        { -1.879974687937391E-01, 9.723918744740695E-01, 1.502266466385545E-04, 2450449.500000000 },
        { -1.852973671071030E-01, 9.707073909890066E-01, 2.038292204486176E-04, 2450814.500000000 },
        { -1.812462835433389E-01, 9.683084170298228E-01, 2.246005351130080E-04, 2451179.500000000 },
        { -1.756895923710389E-01, 9.659716389047325E-01, 2.050320357914808E-04, 2451544.500000000 },
        { -1.859727476157871E-01, 9.615145430270804E-01, 1.526552444340980E-04, 2451910.500000000 },
        { -1.784737939702473E-01, 9.616853025221062E-01, 7.628265454823633E-05, 2452275.500000000 },
        { -1.711612719829331E-01, 9.632738065789213E-01, -3.528393275263056E-06, 2452640.500000000 },
        { -1.646618171307432E-01, 9.660030341572338E-01, -6.992341644569110E-05, 2453005.500000000 },
        { -1.766700086021553E-01, 9.662215473613915E-01, -1.143823192687004E-04, 2453371.500000000 },
        { -1.726628613130954E-01, 9.695511538661681E-01, -1.302565637315336E-04, 2453736.500000000 },
        { -1.697356786405157E-01, 9.722453406217355E-01, -1.193316906953144E-04, 2454101.500000000 },
        { -1.675444337270497E-01, 9.738318399949668E-01, -8.848710649715632E-05, 2454466.500000000 },
        { -1.825608167327640E-01, 9.711008719607999E-01, -4.698794228343446E-05, 2454832.500000000 },
        { -1.797715485736939E-01, 9.703755165238434E-01, -1.706996375738587E-05, 2455197.500000000 },
        { -1.757849695076524E-01, 9.689520155380916E-01, -9.635607098656008E-06, 2455562.500000000 },
        { -1.704289612307356E-01, 9.676797905320725E-01, -2.865007059472918E-05, 2455927.500000000 },
        { -1.813315182090570E-01, 9.642400629406905E-01, -7.137221397917920E-05, 2456293.500000000 },
        { -1.746023861435523E-01, 9.652466823965693E-01, -1.228941395836774E-04, 2456658.500000000 },
        { -1.683043029279065E-01, 9.674681644757311E-01, -1.685600928909706E-04, 2457023.500000000 },
        { -1.630555547914525E-01, 9.704743498488413E-01, -1.954449293771164E-04, 2457388.500000000 },
        { -1.762070200039048E-01, 9.707077891066944E-01, -1.917099515650224E-04, 2457754.500000000 },
        { -1.734145901188724E-01, 9.737225849579471E-01, -1.602454459094069E-04, 2458119.500000000 },
        { -1.715347694309459E-01, 9.757795209138563E-01, -1.008535277045535E-04, 2458484.500000000 },
        { -1.701126893061850E-01, 9.765523312965528E-01, -2.102377129551278E-05, 2458849.500000000 },
        { -1.857840478900447E-01, 9.728432606375694E-01, 6.078381994148240E-05, 2459215.500000000 },
        { -1.832411496499692E-01, 9.710404310992504E-01, 1.267721580522679E-04, 2459580.500000000 },
        { -1.792839699266754E-01, 9.685981150929354E-01, 1.608160815816363E-04, 2459945.500000000 },
        { -1.738483795201916E-01, 9.663383858349351E-01, 1.573550938213200E-04, 2460310.500000000 },
        { -1.844009902126555E-01, 9.620442142270554E-01, 1.258478346219314E-04, 2460676.500000000 },
        { -1.773363685984708E-01, 9.622526529774579E-01, 7.474448887485198E-05, 2461041.500000000 },
        { -1.705639643353804E-01, 9.636816750995446E-01, 2.315249996880005E-05, 2461406.500000000 },
        { -1.646226336051575E-01, 9.660113346351458E-01, -1.406139605096370E-05, 2461771.500000000 },
        { -1.770776147012875E-01, 9.656489000721793E-01, -3.186425548228006E-05, 2462137.500000000 },
        { -1.733220398892484E-01, 9.681500191109668E-01, -2.661975968136289E-05, 2462502.500000000 },
        { -1.703883484267699E-01, 9.698886494773914E-01, -2.213925681994726E-06, 2462867.500000000 },
        { -1.678779896136586E-01, 9.704918849740369E-01, 3.203498463062137E-05, 2463232.500000000 },
        { -1.822576881036353E-01, 9.669087598518451E-01, 6.531329338869381E-05, 2463598.500000000 },
        { -1.785225746754157E-01, 9.655158757764858E-01, 7.556086601686436E-05, 2463963.500000000 },
        { -1.734498507486709E-01, 9.637601379127522E-01, 5.487959439454784E-05, 2464328.500000000 },
	};

    POSITION_TEST( EarthSchlyterOrbitalEphemeris, "Earth Position", 1.0 );
	return true;
}
